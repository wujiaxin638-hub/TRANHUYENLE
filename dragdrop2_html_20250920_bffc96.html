<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰è¯­æ–¹ä½è¯æ‹–æ”¾æ¸¸æˆ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 800px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2575fc;
            margin-bottom: 20px;
            font-size: 28px;
        }
        
        .instructions {
            background: #f0f8ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .instructions h2 {
            color: #6a11cb;
            margin-bottom: 10px;
        }
        
        .instructions ol {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            background: #f0f8ff;
            padding: 15px;
            border-radius: 12px;
            font-weight: bold;
        }
        
        .level, .score {
            font-size: 18px;
            color: #6a11cb;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .sentence-display {
            font-size: 24px;
            margin-bottom: 30px;
            color: #2c3e50;
            font-weight: bold;
            min-height: 60px;
            padding: 15px;
            background: #e9f7ff;
            border-radius: 12px;
            width: 100%;
        }
        
        .pinyin-display {
            font-size: 18px;
            margin-top: 10px;
            color: #6a11cb;
            display: none;
        }
        
        .drop-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 15px;
            width: 400px;
            height: 400px;
            margin-bottom: 30px;
            position: relative;
            background: #f8f9fa;
            border: 2px dashed #6a11cb;
            border-radius: 15px;
            padding: 20px;
        }
        
        .drop-target {
            width: 100px;
            height: 100px;
            border: 2px solid #2575fc;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            font-weight: bold;
            background: white;
        }
        
        .center-target {
            grid-column: 2;
            grid-row: 2;
            background: #e9f7ff;
        }
        
        .north-target {
            grid-column: 2;
            grid-row: 1;
            background: #ffe9ec;
        }
        
        .south-target {
            grid-column: 2;
            grid-row: 3;
            background: #e9ffe9;
        }
        
        .east-target {
            grid-column: 3;
            grid-row: 2;
            background: #e9f7ff;
        }
        
        .west-target {
            grid-column: 1;
            grid-row: 2;
            background: #fff4e9;
        }
        
        .drag-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .drag-item {
            width: 100px;
            height: 100px;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            font-weight: bold;
            cursor: move;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            user-select: none;
        }
        
        .drag-item:hover {
            transform: translateY(-5px);
        }
        
        .circle {
            background: white;
            border: 3px solid #6a11cb;
            border-radius: 50%;
        }
        
        .square {
            background: #2575fc;
            color: white;
            border: 3px solid #6a11cb;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        #playSound {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
        }
        
        #checkBtn {
            background: linear-gradient(to right, #25ac64, #2fe87a);
            color: white;
        }
        
        #nextBtn {
            background: linear-gradient(to right, #ff8a00, #ffb900);
            color: white;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 12px;
            font-weight: bold;
            display: none;
        }
        
        .correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .progress-bar {
            height: 12px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 25px 0;
            overflow: hidden;
            width: 100%;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .level-up {
            animation: levelUp 1s ease;
        }
        
        @keyframes levelUp {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .game-complete {
            text-align: center;
            padding: 30px;
            display: none;
        }
        
        .game-complete h2 {
            color: #6a11cb;
            margin-bottom: 20px;
        }
        
        .restart-btn {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            margin-top: 20px;
        }
        
        @media (max-width: 600px) {
            .drop-container {
                width: 300px;
                height: 300px;
            }
            
            .drop-target, .drag-item {
                width: 80px;
                height: 80px;
                font-size: 14px;
            }
            
            .sentence-display {
                font-size: 18px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ±‰è¯­æ–¹ä½è¯æ‹–æ”¾æ¸¸æˆ</h1>
        
        <div class="instructions">
            <h2>æ¸¸æˆæŒ‡å—</h2>
            <ol>
                <li>ç‚¹å‡»"æ’­æ”¾è¯­éŸ³"æŒ‰é’®å¬å¥å­</li>
                <li>æ ¹æ®å¥å­æ„æ€ï¼Œå°†è“è‰²æ–¹å—æ‹–æ”¾åˆ°æ­£ç¡®çš„ä½ç½®</li>
                <li>ç™½è‰²åœ†å½¢æ˜¯å›ºå®šçš„å‚è€ƒç‚¹</li>
                <li>æ£€æŸ¥ç­”æ¡ˆåï¼Œå¦‚æœæ­£ç¡®ï¼Œä¼šæ˜¾ç¤ºåŸå¥å’Œæ‹¼éŸ³</li>
                <li>ç‚¹å‡»"ä¸‹ä¸€é¢˜"ç»§ç»­</li>
                <li>å®Œæˆæ‰€æœ‰é¢˜ç›®åæ¸¸æˆç»“æŸ</li>
            </ol>
        </div>
        
        <div class="game-info">
            <div class="level">å…³å¡: <span id="level">1</span>/10</div>
            <div class="score">å¾—åˆ†: <span id="score">0</span></div>
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <div class="game-area">
            <div class="sentence-display" id="sentenceDisplay">ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¬å¥å­</div>
            <div class="pinyin-display" id="pinyinDisplay"></div>
            
            <div class="drop-container">
                <div class="drop-target north-target" id="north">åŒ—è¾¹</div>
                <div class="drop-target west-target" id="west">è¥¿è¾¹</div>
                <div class="drop-target center-target" id="center">ä¸­å¿ƒ</div>
                <div class="drop-target east-target" id="east">ä¸œè¾¹</div>
                <div class="drop-target south-target" id="south">å—è¾¹</div>
            </div>
            
            <div class="drag-container" id="dragContainer">
                <!-- æ‹–æ‹½å…ƒç´ å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="feedback" id="feedback"></div>
        
        <div class="controls">
            <button id="playSound">æ’­æ”¾è¯­éŸ³</button>
            <button id="checkBtn">æ£€æŸ¥ç­”æ¡ˆ</button>
            <button id="nextBtn">ä¸‹ä¸€é¢˜</button>
        </div>
        
        <div class="game-complete" id="gameComplete">
            <h2>æ­å–œæ‚¨å®Œæˆæ‰€æœ‰å…³å¡ï¼</h2>
            <p>æ‚¨çš„æœ€ç»ˆå¾—åˆ†: <span id="finalScore">0</span></p>
            <button class="restart-btn" id="restartBtn">é‡æ–°å¼€å§‹</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = [
            {
                sentence: "å›¾ä¹¦é¦†åœ¨æ•™å­¦æ¥¼åŒ—è¾¹ã€‚",
                pinyin: "TÃºshÅ«guÇn zÃ i jiÃ oxuÃ©lÃ³u bÄ›ibian.",
                circles: ["æ•™å­¦æ¥¼"],
                squares: ["å›¾ä¹¦é¦†"],
                correctPosition: {square: "å›¾ä¹¦é¦†", relativeTo: "æ•™å­¦æ¥¼", direction: "north"}
            },
            {
                sentence: "è¶…å¸‚åœ¨é¥­é¦†ä¸œè¾¹ã€‚",
                pinyin: "ChÄoshÃ¬ zÃ i fÃ nguÇn dÅngbian.",
                circles: ["é¥­é¦†"],
                squares: ["è¶…å¸‚"],
                correctPosition: {square: "è¶…å¸‚", relativeTo: "é¥­é¦†", direction: "east"}
            },
            {
                sentence: "è¶…å¸‚åœ¨é¥­é¦†è¥¿è¾¹ã€‚",
                pinyin: "ChÄoshÃ¬ zÃ i fÃ nguÇn xÄ«bian.",
                circles: ["é¥­é¦†"],
                squares: ["è¶…å¸‚"],
                correctPosition: {square: "è¶…å¸‚", relativeTo: "é¥­é¦†", direction: "west"}
            },
            {
                sentence: "è¿åŠ¨åœºåœ¨æ•™å­¦æ¥¼è¥¿è¾¹ã€‚",
                pinyin: "YÃ¹ndÃ²ngchÇng zÃ i jiÃ oxuÃ©lÃ³u xÄ«bian.",
                circles: ["æ•™å­¦æ¥¼"],
                squares: ["è¿åŠ¨åœº"],
                correctPosition: {square: "è¿åŠ¨åœº", relativeTo: "æ•™å­¦æ¥¼", direction: "west"}
            },
            {
                sentence: "è¿åŠ¨åœºåœ¨ä½“è‚²é¦†å—è¾¹ã€‚",
                pinyin: "YÃ¹ndÃ²ngchÇng zÃ i tÇyÃ¹guÇn nÃ¡nbian.",
                circles: ["ä½“è‚²é¦†"],
                squares: ["è¿åŠ¨åœº"],
                correctPosition: {square: "è¿åŠ¨åœº", relativeTo: "ä½“è‚²é¦†", direction: "south"}
            },
            {
                sentence: "æˆ‘åœ¨å›¾ä¹¦é¦†åŒ—è¾¹ã€‚",
                pinyin: "WÇ’ zÃ i tÃºshÅ«guÇn bÄ›ibian.",
                circles: ["å›¾ä¹¦é¦†"],
                squares: ["æˆ‘"],
                correctPosition: {square: "æˆ‘", relativeTo: "å›¾ä¹¦é¦†", direction: "north"}
            },
            {
                sentence: "å›¾ä¹¦é¦†åœ¨æ•™å­¦æ¥¼åŒ—è¾¹ã€‚",
                pinyin: "TÃºshÅ«guÇn zÃ i jiÃ oxuÃ©lÃ³u bÄ›ibian.",
                circles: ["æ•™å­¦æ¥¼"],
                squares: ["å›¾ä¹¦é¦†"],
                correctPosition: {square: "å›¾ä¹¦é¦†", relativeTo: "æ•™å­¦æ¥¼", direction: "north"}
            },
            {
                sentence: "è¿åŠ¨åœºå’Œä½“è‚²é¦†åœ¨æ•™å­¦æ¥¼è¥¿è¾¹ã€‚",
                pinyin: "YÃ¹ndÃ²ngchÇng hÃ© tÇyÃ¹guÇn zÃ i jiÃ oxuÃ©lÃ³u xÄ«bian.",
                circles: ["æ•™å­¦æ¥¼"],
                squares: ["è¿åŠ¨åœº", "ä½“è‚²é¦†"],
                correctPosition: [
                    {square: "è¿åŠ¨åœº", relativeTo: "æ•™å­¦æ¥¼", direction: "west"},
                    {square: "ä½“è‚²é¦†", relativeTo: "æ•™å­¦æ¥¼", direction: "west"}
                ]
            },
            {
                sentence: "ç•™å­¦ç”Ÿæ¥¼åœ¨è¿åŠ¨åœºå—è¾¹ã€‚",
                pinyin: "LiÃºxuÃ©shÄ“ng lÃ³u zÃ i yÃ¹ndÃ²ngchÇng nÃ¡nbian.",
                circles: ["è¿åŠ¨åœº"],
                squares: ["ç•™å­¦ç”Ÿæ¥¼"],
                correctPosition: {square: "ç•™å­¦ç”Ÿæ¥¼", relativeTo: "è¿åŠ¨åœº", direction: "south"}
            },
            {
                sentence: "ç•™å­¦ç”Ÿæ¥¼è¥¿è¾¹æœ‰ä¸€ä¸ªé¥­é¦†ï¼Œè¿˜æœ‰ä¸€ä¸ªè¶…å¸‚ã€‚",
                pinyin: "LiÃºxuÃ©shÄ“ng lÃ³u xÄ«bian yÇ’u yÄ«gÃ¨ fÃ nguÇn, hÃ¡i yÇ’u yÄ«gÃ¨ chÄoshÃ¬.",
                circles: ["ç•™å­¦ç”Ÿæ¥¼"],
                squares: ["é¥­é¦†", "è¶…å¸‚"],
                correctPosition: [
                    {square: "é¥­é¦†", relativeTo: "ç•™å­¦ç”Ÿæ¥¼", direction: "west"},
                    {square: "è¶…å¸‚", relativeTo: "ç•™å­¦ç”Ÿæ¥¼", direction: "west"}
                ]
            }
        ];

        // è¯æ±‡åº“
        const vocabulary = [
            "æ•™å­¦æ¥¼", "å›¾ä¹¦é¦†", "è¿åŠ¨åœº", "ä½“è‚²é¦†", "é¥­é¦†", 
            "è¶…å¸‚", "é“¶è¡Œ", "ä¸­å›½é“¶è¡Œ", "å«ç”Ÿé—´", "å•†åº—", 
            "ä¹¦åº—", "é‚®å±€", "æ¡Œå­", "è‹¹æœ", "ä¹¦", "ç¬”", "æˆ‘", "ç•™å­¦ç”Ÿæ¥¼"
        ];

        // æ¸¸æˆçŠ¶æ€å˜é‡
        let currentLevel = 0;
        let score = 0;
        let draggedElement = null;
        let currentPositions = {};

        // DOMå…ƒç´ 
        const levelElement = document.getElementById('level');
        const scoreElement = document.getElementById('score');
        const progressElement = document.getElementById('progress');
        const sentenceDisplay = document.getElementById('sentenceDisplay');
        const pinyinDisplay = document.getElementById('pinyinDisplay');
        const dragContainer = document.getElementById('dragContainer');
        const feedbackElement = document.getElementById('feedback');
        const playSoundBtn = document.getElementById('playSound');
        const checkBtn = document.getElementById('checkBtn');
        const nextBtn = document.getElementById('nextBtn');
        const gameCompleteElement = document.getElementById('gameComplete');
        const finalScoreElement = document.getElementById('finalScore');
        const restartBtn = document.getElementById('restartBtn');
        const dropTargets = {
            north: document.getElementById('north'),
            south: document.getElementById('south'),
            east: document.getElementById('east'),
            west: document.getElementById('west'),
            center: document.getElementById('center')
        };

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            currentLevel = 0;
            score = 0;
            currentPositions = {};
            updateUI();
            loadLevel();
            
            // éšè—æ¸¸æˆå®Œæˆç•Œé¢ï¼Œæ˜¾ç¤ºæ¸¸æˆç•Œé¢
            gameCompleteElement.style.display = 'none';
            document.querySelector('.game-info').style.display = 'flex';
            document.querySelector('.progress-bar').style.display = 'block';
            sentenceDisplay.style.display = 'block';
            pinyinDisplay.style.display = 'none';
            document.querySelector('.drop-container').style.display = 'grid';
            dragContainer.style.display = 'flex';
            feedbackElement.style.display = 'none';
            document.querySelector('.controls').style.display = 'flex';
        }

        // æ›´æ–°UIæ˜¾ç¤º
        function updateUI() {
            levelElement.textContent = currentLevel + 1;
            scoreElement.textContent = score;
            progressElement.style.width = `${((currentLevel + 1) / gameData.length) * 100}%`;
        }

        // åŠ è½½å…³å¡
        function loadLevel() {
            const levelData = gameData[currentLevel];
            sentenceDisplay.textContent = "ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¬å¥å­";
            pinyinDisplay.style.display = 'none';
            
            // æ¸…ç©ºæ‹–æ‹½å®¹å™¨
            dragContainer.innerHTML = "";
            currentPositions = {};
            
            // æ¸…ç©ºæ‰€æœ‰æ”¾ç½®åŒºåŸŸï¼ˆé™¤äº†æ–¹å‘æ ‡ç­¾ï¼‰
            for (const direction in dropTargets) {
                dropTargets[direction].innerHTML = direction === "north" ? "åŒ—è¾¹" : 
                                                 direction === "south" ? "å—è¾¹" : 
                                                 direction === "east" ? "ä¸œè¾¹" : 
                                                 direction === "west" ? "è¥¿è¾¹" : "ä¸­å¿ƒ";
                dropTargets[direction].style.backgroundColor = "";
            }
            
            // åˆ›å»ºåœ†å½¢å…ƒç´ ï¼ˆå›ºå®šçš„ï¼‰
            levelData.circles.forEach(word => {
                const circle = document.createElement('div');
                circle.className = 'drag-item circle';
                circle.textContent = word;
                circle.id = `circle-${word}`;
                circle.setAttribute('data-type', 'circle');
                circle.setAttribute('data-word', word);
                circle.draggable = false; // åœ†å½¢ä¸å¯æ‹–æ‹½
                
                // å°†åœ†å½¢æ”¾åœ¨ä¸­å¿ƒä½ç½®
                dropTargets.center.appendChild(circle);
                currentPositions[word] = "center";
            });
            
            // åˆ›å»ºæ–¹å½¢å…ƒç´ ï¼ˆå¯æ‹–æ‹½çš„ï¼‰
            levelData.squares.forEach(word => {
                const square = document.createElement('div');
                square.className = 'drag-item square';
                square.textContent = word;
                square.id = `square-${word}`;
                square.setAttribute('data-type', 'square');
                square.setAttribute('data-word', word);
                square.draggable = true;
                
                // æ·»åŠ æ‹–æ‹½äº‹ä»¶ç›‘å¬
                square.addEventListener('dragstart', dragStart);
                square.addEventListener('dragend', dragEnd);
                
                dragContainer.appendChild(square);
            });
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            nextBtn.disabled = true;
            checkBtn.disabled = false;
        }

        // æ‹–æ‹½å¼€å§‹
        function dragStart(e) {
            draggedElement = this;
            setTimeout(() => {
                this.style.opacity = '0.5';
            }, 0);
        }

        // æ‹–æ‹½ç»“æŸ
        function dragEnd(e) {
            this.style.opacity = '1';
            
            // æ‰¾åˆ°æ‰€æœ‰å¯æ”¾ç½®åŒºåŸŸ
            const dropZones = document.querySelectorAll('.drop-target');
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', dragOver);
                zone.addEventListener('dragenter', dragEnter);
                zone.addEventListener('dragleave', dragLeave);
                zone.addEventListener('drop', drop);
            });
        }

        // æ‹–æ‹½ç»è¿‡
        function dragOver(e) {
            e.preventDefault();
        }

        // æ‹–æ‹½è¿›å…¥
        function dragEnter(e) {
            e.preventDefault();
            if (this.id !== "center") {
                this.style.backgroundColor = '#f0f8ff';
            }
        }

        // æ‹–æ‹½ç¦»å¼€
        function dragLeave(e) {
            if (this.id !== "center") {
                this.style.backgroundColor = '';
            }
        }

        // æ”¾ç½®
        function drop(e) {
            e.preventDefault();
            if (this.id !== "center") {
                this.style.backgroundColor = '';
                
                // è·å–æ–¹å‘
                const direction = this.id;
                
                // è·å–æ‹–æ‹½å…ƒç´ çš„è¯æ±‡
                const word = draggedElement.getAttribute('data-word');
                
                // è®°å½•ä½ç½®
                currentPositions[word] = direction;
                
                // å°†å…ƒç´ æ·»åŠ åˆ°æ”¾ç½®åŒºåŸŸ
                this.appendChild(draggedElement);
            }
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const levelData = gameData[currentLevel];
            const correct = levelData.correctPosition;
            let isCorrect = true;
            
            // å¤„ç†å•ä¸ªæˆ–å¤šä¸ªæ­£ç¡®ç­”æ¡ˆ
            if (Array.isArray(correct)) {
                // å¤šä¸ªæ­£ç¡®ç­”æ¡ˆçš„æƒ…å†µ
                for (const correctPos of correct) {
                    const userSquarePosition = currentPositions[correctPos.square];
                    if (userSquarePosition !== correctPos.direction) {
                        isCorrect = false;
                        break;
                    }
                }
            } else {
                // å•ä¸ªæ­£ç¡®ç­”æ¡ˆçš„æƒ…å†µ
                const userSquarePosition = currentPositions[correct.square];
                if (userSquarePosition !== correct.direction) {
                    isCorrect = false;
                }
            }
            
            if (isCorrect) {
                feedbackElement.textContent = "æ­£ç¡®! ğŸ‘";
                feedbackElement.className = "feedback correct";
                score += 10;
                
                // æ˜¾ç¤ºåŸå¥å’Œæ‹¼éŸ³
                sentenceDisplay.textContent = levelData.sentence;
                pinyinDisplay.textContent = levelData.pinyin;
                pinyinDisplay.style.display = "block";
                
                // é«˜äº®æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ
                if (Array.isArray(correct)) {
                    correct.forEach(pos => {
                        dropTargets[pos.direction].style.backgroundColor = '#d4edda';
                    });
                } else {
                    dropTargets[correct.direction].style.backgroundColor = '#d4edda';
                }
            } else {
                feedbackElement.textContent = "ä¸å¯¹! è¯·å†è¯•ä¸€æ¬¡ã€‚";
                feedbackElement.className = "feedback incorrect";
                
                // é«˜äº®æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ
                if (Array.isArray(correct)) {
                    correct.forEach(pos => {
                        dropTargets[pos.direction].style.backgroundColor = '#d4edda';
                    });
                } else {
                    dropTargets[correct.direction].style.backgroundColor = '#d4edda';
                }
            }
            
            feedbackElement.style.display = "block";
            nextBtn.disabled = false;
            checkBtn.disabled = true;
            
            updateUI();
        }

        // æ’­æ”¾è¯­éŸ³
        function playSentenceSound() {
            const levelData = gameData[currentLevel];
            sentenceDisplay.textContent = levelData.sentence;
            pinyinDisplay.style.display = 'none';
            
            // ä½¿ç”¨Web Speech APIæ’­æ”¾ä¸­æ–‡
            const utterance = new SpeechSynthesisUtterance(levelData.sentence);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.8; // ç¨æ…¢çš„è¯­é€Ÿä¾¿äºå­¦ä¹ 
            
            speechSynthesis.speak(utterance);
        }

        // ä¸‹ä¸€å…³
        function nextLevel() {
            currentLevel++;
            
            if (currentLevel >= gameData.length) {
                endGame();
            } else {
                loadLevel();
                feedbackElement.style.display = "none";
            }
        }

        // ç»“æŸæ¸¸æˆ
        function endGame() {
            finalScoreElement.textContent = score;
            gameCompleteElement.style.display = 'block';
            
            // éšè—æ¸¸æˆç•Œé¢
            document.querySelector('.game-info').style.display = 'none';
            document.querySelector('.progress-bar').style.display = 'none';
            sentenceDisplay.style.display = 'none';
            pinyinDisplay.style.display = 'none';
            document.querySelector('.drop-container').style.display = 'none';
            dragContainer.style.display = 'none';
            feedbackElement.style.display = 'none';
            document.querySelector('.controls').style.display = 'none';
        }

        // äº‹ä»¶ç›‘å¬
        playSoundBtn.addEventListener('click', playSentenceSound);
        checkBtn.addEventListener('click', checkAnswer);
        nextBtn.addEventListener('click', nextLevel);
        restartBtn.addEventListener('click', initGame);

        // åˆå§‹åŒ–æ‹–æ”¾åŒºåŸŸäº‹ä»¶
        const dropZones = document.querySelectorAll('.drop-target');
        dropZones.forEach(zone => {
            zone.addEventListener('dragover', dragOver);
            zone.addEventListener('dragenter', dragEnter);
            zone.addEventListener('dragleave', dragLeave);
            zone.addEventListener('drop', drop);
        });

        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
    </script>
</body>
</html>